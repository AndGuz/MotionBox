#!/bin/sh

#--------------------------------------------------------------------------------------------------
# Settings
#--------------------------------------------------------------------------------------------------

Sk="../Sk"

#--------------------------------------------------------------------------------------------------

bin4="bin"
bin5="latest"

#--------------------------------------------------------------------------------------------------
# Syntax
#--------------------------------------------------------------------------------------------------

if [ $# != 2 ] || [ $1 != "qt4" -a $1 != "qt5" -a $1 != "clean" ] || [ $2 != "win32" ]; then

    echo "Usage: deploy <qt4 | qt5 | clean> <win32>"

    exit 1
fi

#--------------------------------------------------------------------------------------------------
# Clean
#--------------------------------------------------------------------------------------------------

echo "CLEANING"

rm -rf deploy/*

touch deploy/.gitignore

if [ $1 = "clean" ]; then

    exit 0
fi

echo ""

#--------------------------------------------------------------------------------------------------
# Sk
#--------------------------------------------------------------------------------------------------

echo "DEPLOYING Sk"
echo "------------"

cd "$Sk"

sh deploy.sh $1 $2

cd -

deploy="$Sk/deploy"

cp -r "$deploy"/imageformats deploy
cp -r "$deploy"/plugins      deploy

if [ $1 = "qt5" ]; then

    cp -r "$deploy"/platforms deploy
fi

if [ $2 = "win32" ]; then

    cp "$deploy"/*.dll deploy
fi

echo "------------"
echo ""

#--------------------------------------------------------------------------------------------------
# MotionBox
#--------------------------------------------------------------------------------------------------

echo "COPYING MotionBox"

if [ $1 = "qt4" ]; then

    bin="$bin4"
else
    bin="$bin5"
fi

if [ $2 = "win32" ]; then

    cp "$bin"/MotionBox.exe deploy
fi
